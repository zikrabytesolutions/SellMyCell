<div class="modal" id="editModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="background-color: transparent;">
            <div class="modal-body" style="padding: 0px;">
                <section class="card">
                    <div class="modal-header">
                        <h5 class="modal-title">View Order</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">Ã—</span>
                        </button>
                    </div>
                    <div class="card-body">

                        <div class="row">

                            <div class="form-group col-sm-4">
                                <b>User Name:</b>
                                <span id="full_name"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Phone Number:</b>
                                <span id="mobile"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Order Number:</b>
                                <span id="order_number"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Created:</b>
                                <span id="created"></span>
                            </div>


                            <div class="form-group col-sm-4">
                                <b>Mobile:</b>
                                <span id="mobile_title"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Power On:</b>
                                <span id="power_on"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Box:</b>
                                <span id="box"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Bill:</b>
                                <span id="bill"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Charger:</b>
                                <span id="charger"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Earphone:</b>
                                <span id="earphone"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Device Age:</b>
                                <span id="device_age"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Glass Broken:</b>
                                <span id="glass_broken"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Touch Issue:</b>
                                <span id="touch_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Front Camera Issue:</b>
                                <span id="front_camera_issue"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Back Camera Issue:</b>
                                <span id="back_camera_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Wifi Issue:</b>
                                <span id="wifi_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Battery Issue:</b>
                                <span id="battery_issue"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Speaker Issue:</b>
                                <span id="speaker_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Mic Issue:</b>
                                <span id="mic_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Volume Issue:</b>
                                <span id="volumn_issue"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Charging Pin Issue:</b>
                                <span id="chargingpin_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Power Button Issue:</b>
                                <span id="power_btn_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Fingerprint Issue:</b>
                                <span id="finger_print_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Face Recognition Issue:</b>
                                <span id="face_recog_issue"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Device Condition:</b>
                                <span id="device_condition"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Address Type:</b>
                                <span id="address_type"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Address First:</b>
                                <span id="address_first"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Address Second:</b>
                                <span id="address_second"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Locality:</b>
                                <span id="locality"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>City:</b>
                                <span id="city"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>State:</b>
                                <span id="state"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Pincode:</b>
                                <span id="pincode"></span>
                            </div>

                            <div class="form-group col-sm-4">
                                <b>Payment Type:</b>
                                <span id="payment_type"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>UPI Id:</b>
                                <span id="upi_id"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Account No:</b>
                                <span id="account_no"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Beneficiary Name:</b>
                                <span id="beneficiary_name"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>IFSC Code:</b>
                                <span id="ifsc_code"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Bank Name:</b>
                                <span id="bank_name"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Pickup Date:</b>
                                <span id="pickup_date"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Pickup Time Slot:</b>
                                <span id="pickup_tme_slot"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Final Price:</b>
                                <span id="final_price"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Referral Code:</b>
                                <span id="referral_code"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Comment:</b>
                                <span id="comment"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Placed:</b>
                                <span id="placed"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Processing:</b>
                                <span id="processing"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>On Pickup:</b>
                                <span id="onpickup"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Completed:</b>
                                <span id="completed"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Cancel:</b>
                                <span id="is_cancel"></span>
                            </div>
                            <div class="form-group col-sm-4">
                                <b>Cancel time:</b>
                                <span id="cancel_time"></span>
                            </div>

                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-sm-12">
        <div class="row">
                    <div class="col-sm-6">
                        <h4>Orders</h4>
                    </div>
                     <div class="col-sm-6 text-right">
                        <button class="btn btn-danger" id="delete_multi" disabled>Delete Selected</button>
                    </div>
                
                </div>
        <div class="dt-responsive table-responsive">

            <table id="order_table" class="table table-striped table-bordered nowrap">
                <thead>
                <tr>
                    <th>
                                <input type='checkbox' name='check_all' class='check_all'">

                    </th>
                    <th>Action</th>
                    <th>Processing</th>
                    <th>On Pickup</th>
                    <th>Completed</th>
                    <th>User Name</th>
                    <th>Phone Number</th>
                    <th>Order Number</th>
                    <th>Created</th>
                    <th>Mobile</th>
                    <th>Power_on</th>
                    <th>Box</th>
                    <th>Bill</th>
                    <th>Charger</th>
                    <th>Earphone</th>
                    <th>Device Age</th>
                    <th>Glass Broken</th>
                    <th>Touch Issue</th>
                    <th>Front Camera Issue</th>
                    <th>Back Camera Issue</th>
                    <th>Wifi Issue</th>
                    <th>Battery Issue</th>
                    <th>Speaker Issue</th>
                    <th>Mic Issue</th>
                    <th>Volume Issue</th>
                    <th>Charging Pin Issue</th>
                    <th>Power Button Issue</th>
                    <th>Finger Print Issue	</th>
                    <th>Face Recognition Issue</th>
                    <th>Device Condition</th>
                    <th>Address Type</th>
                    <th>Address First</th>
                    <th>Address Second</th>
                    <th>Locality</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Pincode</th>
                    <th>Payment Type</th>
                    <th>UPI Id</th>
                    <th>Account No</th>
                    <th>Beneficiary Name</th>
                    <th>IFSC Code</th>
                    <th>Bank Name</th>
                    <th>Pickup Date</th>
                    <th>Pickup Time Slot</th>
                    <th>Final Price</th>
                    <th>Referral Code</th>
                    <th>Comment</th>
                    <th>Placed</th>
                    <th>Cancel</th>
                    <th>Cancel Time</th>

                </tr>
                </thead>
                <tbody class="text-center">


                </tbody>
            </table>

        </div>
        <div id="test">

        </div>
    </div>
</div>

<script>
    $(document).ready(function(){

         $('#order_table').DataTable({
            ajax: "<?= base_url('Product/get_orders');?>",
            scrollY:        "500px",
            scrollX:        true,
            scrollCollapse: true,
            paging:         true,

            dom: 'lBfrtip',
            buttons: [
                'copy', 'excel', 'pdf', 'print'
            ],
            "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                if (aData[48] === "No") {
                    $('td', nRow).css('background-color', '#ffeb99');
                }
                else if (aData[49] === "Yes") {
                    $('td', nRow).css('background-color', '#ffad99');
                }
            }
            // initComplete: (settings, json)=>{
            //     $('.dataTables_paginate').appendTo('#test');
            // },
        });
    });

    $(document).on('click','.processing',function(){

        let id = $(this).attr('id');

        if(confirm("Are you sure ?")) {
            if($(this).is(":checked")){

                let status = 1;
                $.ajax({
                    url: '<?= base_url('Product/update_processing') ?>',
                    method: 'POST',
                    dataType:"json",
                    data: {status: status, id: id},

                    success: function(data){
                        if(data.error === 0){

                            Swal.fire({
                                text: "Record updated successfully",
                                showCancelButton: false,
                        showConfirmButton: false,
                                timer: 1000
                            });
                            $('#order_table').DataTable().ajax.reload(null, false);

                        }
                    }
                });
            }

            else if($(this).is(":not(:checked)")){

                let status = 0;
                $.ajax({
                    url: '<?= base_url('Product/update_processing') ?>',
                    method: 'POST',
                    dataType:"json",
                    data: {status: status, id: id},

                    success: function(data){
                        if(data.error === 0){

                            Swal.fire({
                                text: "Record updated successfully",
                                showCancelButton: false,
                        showConfirmButton: false,
                                timer: 1000
                            });
                            $('#order_table').DataTable().ajax.reload(null, false);

                        }
                    }
                });
            }
        }
        else{
            return false;
        }



    });

    $(document).on('click','.onpickup',function(){

        let id = $(this).attr('id');

        if(confirm("Are you sure ?")) {
            if($(this).is(":checked")){
                let status = 1;

                $.ajax({
                    url: '<?= base_url('Product/update_pickup') ?>',
                    method: 'POST',
                    dataType:"json",
                    data: {id: id,status: status},
                    // contentType:false,
                    // processData:false,
                    success: function(data){
                        if(data.error === 0){
                            Swal.fire({
                                text: "Record updated successfully",
                                showCancelButton: false,
                        showConfirmButton: false,
                                showCancelButton: false,
                            showConfirmButton: false,
                                timer: 1000
                            });
                            $('#order_table').DataTable().ajax.reload(null, false);
                        }
                    }
                });
            }

            else if($(this).is(":not(:checked)")){

                let status = 0;

                $.ajax({
                    url: '<?= base_url('Product/update_pickup') ?>',
                    method: 'POST',
                    dataType:"json",
                    data: {id: id,status: status},
                    // contentType:false,
                    // processData:false,
                    success: function(data){
                        if(data.error === 0){
                            Swal.fire({
                                text: "Record updated successfully",
                                showCancelButton: false,
                        showConfirmButton: false,
                                timer: 1000
                            });
                            $('#order_table').DataTable().ajax.reload(null, false);
                        }
                    }
                });
            }
        }

        else{
            return false;
        }

    });

    $(document).on('click','.completed', function(){

        let id = $(this).attr('id');

        if(confirm("Are you sure ?")) {
            if($(this).is(":checked")){

                let status = 1;

                $.ajax({
                    url: '<?= base_url('Product/update_completed') ?>',
                    method: 'POST',
                    dataType:"json",
                    data: {id: id,status: status},
                    // contentType:false,
                    // processData:false,
                    success: function(data){
                        if(data.error === 0){

                            Swal.fire({
                                text: "Record updated successfully",
                                showCancelButton: false,
                        showConfirmButton: false,
                                timer: 1000
                            });

                            $('#order_table').DataTable().ajax.reload(null, false);

                        }
                    }
                });
            }

            else if($(this).is(":not(:checked)")) {

                let status = 0;

                $.ajax({
                    url: '<?= base_url('Product/update_completed') ?>',
                    method: 'POST',
                    dataType:"json",
                    data: {id: id,status: status},
                    // contentType:false,
                    // processData:false,
                    success: function(data){
                        if(data.error === 0){

                            Swal.fire({
                                text: "Record updated successfully",
                                showCancelButton: false,
                        showConfirmButton: false,
                                timer: 1000
                            });

                            $('#order_table').DataTable().ajax.reload(null, false);
                        }
                    }
                });
            }
        }

        else{
            return false;
        }


    });


 $(document).on('click','.updateUser',function(){

        var id = $(this).attr("id");


        $.ajax({
            url:"<?php echo base_url('Product/fetch_order_for_copy'); ?>",
            data: {id:id},
            method:"POST",
            dataType:"json",
            success: function (data) {

                $('#editModal').modal('show');
                $("#full_name").text(data.full_name);
                $("#mobile").text(data.mobile);
                $("#order_number").text(data.order_number);
                $("#created").text(data.created);
                $("#mobile_title").text(data.mobile_title);
                $("#power_on").text((data.power_on === '1')?"Yes":"No");
                $("#box").text((data.box === '1')?"Yes":"No");
                $("#bill").text((data.bill === '1')?"Yes":"No");
                $("#charger").text((data.charger === '1')?"Yes":"No");
                $("#earphone").text((data.earphone === '1')?"Yes":"No");
                $("#device_age").text(data.device_age);
                $("#glass_broken").text((data.glass_broken === '1')?"Yes":"No");
                $("#touch_issue").text((data.touch_issue === '1')?"Yes":"No");
                $("#front_camera_issue").text((data.front_camera_issue === '1')?"Yes":"No");
                $("#back_camera_issue").text((data.back_camera_issue === '1')?"Yes":"No");
                $("#wifi_issue").text((data.wifi_issue === '1')?"Yes":"No");
                $("#battery_issue").text((data.battery_issue === '1')?"Yes":"No");
                $("#speaker_issue").text((data.speaker_issue === '1')?"Yes":"No");
                $("#mic_issue").text((data.mic_issue === '1')?"Yes":"No");
                $("#volumn_issue").text((data.volumn_issue === '1')?"Yes":"No");
                $("#chargingpin_issue").text((data.chargingpin_issue === '1')?"Yes":"No");
                $("#power_btn_issue").text((data.power_btn_issue === '1')?"Yes":"No");
                $("#finger_print_issue").text((data.finger_print_issue === '1')?"Yes":"No");
                $("#face_recog_issue").text((data.face_recog_issue === '1')?"Yes":"No");
                $("#device_condition").text(data.device_condition);
                $("#address_type").text(data.address_type);
                $("#address_first").text(data.address_first);
                $("#address_second").text(data.address_second);
                $("#locality").text(data.locality);
                $("#city").text(data.city);
                $("#state").text(data.state);
                $("#pincode").text(data.pincode);
                $("#payment_type").text(data.payment_type);
                $("#upi_id").text(data.upi_id === '' ? "NA" : data.upi_id);
                $("#account_no").text(data.account_no === '' ? "NA" : data.account_no);
                $("#beneficiary_name").text(data.beneficiary_name === '' ? "NA" : data.beneficiary_name);
                $("#ifsc_code").text(data.ifsc_code === '' ? "NA" : data.ifsc_code);
                $("#bank_name").text(data.bank_name === '' ? "NA" : data.bank_name);
                $("#pickup_date").text(data.pickup_date);
                $("#pickup_tme_slot").text(data.pickup_tme_slot);
                $("#final_price").text(data.final_price);
                $("#referral_code").text(data.referral_code === '' ? "NA" : data.referral_code);
                $("#comment").text(data.comment === '' ? "NA" : data.comment);
                $("#placed").text((data.placed === '1')?"Yes":"No");
                $("#processing").text((data.processing === '1')?"Yes":"No");
                $("#onpickup").text((data.onpickup === '1')?"Yes":"No");
                $("#completed").text((data.completed === '1')?"Yes":"No");
                $("#is_cancel").text((data.is_cancel === '1')?"Yes":"No");
                $("#cancel_time").text(data.cancel_time);
            }
        });
    });
    
    $(document).on('click','.multi_del', function() {

        if($(".multi_del:checked").length > 0){
            $('#delete_multi').removeAttr("disabled","disabled");
        }
        else{
            $('#delete_multi').attr("disabled","disabled");
        }
        
    });
    
    $(document).on('click','.check_all', function(){
        $('.multi_del').not(this).prop('checked', this.checked);
        if($(".multi_del:checked").length > 0){
            $('#delete_multi').removeAttr("disabled","disabled");
        }
        else{
            $('#delete_multi').attr("disabled","disabled");
        }
    });
    
     $(document).on('click','#delete_multi',function(e){

        e.preventDefault(e);

        var id = [];
        $.each($("input[name='multi_del']:checked"), function(){
            id.push($(this).val());
        });
        
    


        let table_name = "cls_order";
        let path = "./upload/models/";
        const swalWithBootstrapButtons = Swal.mixin({
            customClass: {
                confirmButton: 'btn btn-success',
                cancelButton: 'btn btn-danger'
            },
            buttonsStyling: false
        });

        swalWithBootstrapButtons.fire({
            title: 'Are you sure?',
            type: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'No, cancel!',
            reverseButtons: true
        }).then((result) => {
            if (result.value) {

                $.ajax({
                    url: '<?= base_url('Product/common_multi_delete'); ?>',
                    dataType: 'json',
                    method: 'POST',
                    data: {id: id,table_name:table_name,path:path},

                    success: function (data) {
                        if(data.error === 0){
                            swalWithBootstrapButtons.fire(
                                'Deleted!',
                                data.msg,
                                'success'
                            );
                            $('#order_table').DataTable().ajax.reload(null, false);
                        }
                    }
                });


            } else if (
                /* Read more about handling dismissals below */
                result.dismiss === Swal.DismissReason.cancel
            ) {
                swalWithBootstrapButtons.fire(
                    'Cancelled',
                )
                $('#order_table').DataTable().ajax.reload(null, false);
            }
         });
         
    });
    
    $(document).on('click','.deleteUser',function(e){

        e.preventDefault(e);

        let id = $(this).attr('id');

        const swalWithBootstrapButtons = Swal.mixin({
            customClass: {
                confirmButton: 'btn btn-success',
                cancelButton: 'btn btn-danger'
            },
            buttonsStyling: false
        });

        swalWithBootstrapButtons.fire({
            title: 'Are you sure?',
            type: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'No, cancel!',
            reverseButtons: true
        }).then((result) => {
            if (result.value) {

                $.ajax({
                    url: '<?= base_url('Product/order_delete'); ?>',
                    dataType: 'json',
                    method: 'POST',
                    data: {id: id},

                    success: function (data) {
                        if(data.error === 0){
                            swalWithBootstrapButtons.fire(
                                'Deleted!',
                                data.msg,
                                'success'
                            );
                            $('#order_table').DataTable().ajax.reload(null, false);
                        }
                    }
                });


            } else if (
                /* Read more about handling dismissals below */
                result.dismiss === Swal.DismissReason.cancel
            ) {
                swalWithBootstrapButtons.fire(
                    'Cancelled',
                )
                $('#order_table').DataTable().ajax.reload(null, false);
            }
        });
    });

    $("#l_order").addClass('active');
</script>